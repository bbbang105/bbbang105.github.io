---
date: 2024-11-16
tags:
  - springboot
  - backend
  - security
---

---

# ğŸ“ ì„œë¡ 

ì–¼ë§ˆ ì „ í•œêµ­ëŒ€í•™ìƒITê²½ì˜í•™íšŒ(KUSITMS) 30ê¸°ì˜ ìŠ¤í…ì—…ë°ì´ê°€ ìˆì—ˆë‹¤.

ìŠ¤í…ì—…ë°ì´ëŠ” ë‹¤ë¥¸ ë°‹ì—… í”„ë¡œì íŠ¸ íŒ€ê³¼ ìƒí˜¸ í”¼ë“œë°±ì„ ì§„í–‰í•˜ë©°,
ëª¨ë¥´ëŠ” ë¶€ë¶„ì€ ë¬¼ì–´ë³´ê¸°ë„ í•˜ê³  UTë„ ì§„í–‰í•˜ë©° ê° íŒ€ì˜ ì—­ëŸ‰ì„ í–¥ìƒì‹œí‚¤ëŠ” ì»¤ë¦¬í˜ëŸ¼ì´ë‹¤!

ë‚˜ëŠ” ì²« íƒ€ì„ ë•Œ GíŒ€ì˜ ë°±ì—”ë“œ ê°œë°œìë“¤ê³¼ ëŒ€í™”ë¥¼ ë‚˜ëˆ„ì—ˆê³ , í•´ë‹¹ íŒ€ì—ì„œ ê²ªê³  ìˆëŠ” ì—ëŸ¬ì— ëŒ€í•´ì„œë„ ê³µìœ  ë°›ê²Œ ë˜ì—ˆë‹¤.
ë§ˆì¹¨ ì–¼ë§ˆ ì „ì— ì—ëŸ¬ ì²˜ë¦¬ì— ëŒ€í•´ì„œ ê³µë¶€ë¥¼ í•˜ê³  ë¦¬íŒ©í† ë§ì„ ì§„í–‰í–ˆë˜ í„°ë¼, ë„ì›€ì„ ì£¼ê³ ì í•˜ì˜€ì§€ë§Œ ì²˜ìŒ ë³´ëŠ” ë¬¸ì œì˜€ê¸°ì— ì§§ì€ ì‹œê°„ ë‚´ì— í•´ê²°í•  ìˆ˜ëŠ” ì—†ì—ˆë‹¤.

ë•Œë¬¸ì— ì–‘í•´ë¥¼ êµ¬í•˜ê³  ì½”ë“œë¥¼ ë°›ì•„ ì„¸ì…˜ì´ ëë‚œ í›„ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…ì„ ì§„í–‰í–ˆê³ , ê²°êµ­ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆì—ˆë‹¤!
ì´ ê³¼ì •ì—ì„œ ìƒˆë¡­ê²Œ ì•Œê²Œ ëœ ì ë“¤ì´ ìˆì–´ ê¸€ë¡œ í•œ ë²ˆ ì •ë¦¬í•´ë³´ë ¤ê³  í•œë‹¤ âœğŸ»

---

# ğŸ‘¿ ë¬¸ì œì 

ë¬¸ì œëŠ” ë‹¤ìŒê³¼ ê°™ì•˜ë‹¤.

```java
    @PostMapping("/register")
    public ResponseEntity<ApiResponse<UserResponse.UserDto>> registerUser(
            HttpServletResponse response,
            @RequestHeader("registerToken") String registerToken,
            @RequestBody UserRequest.UserRegisterDto userRegisterDto
            ) {
        UserResponse.UserDto registerResponse = userService.registerUser(response, registerToken, userRegisterDto);
        return ApiResponse.success(UserSuccessStatus.USER_REGISTER_SUCCESS, registerResponse);
    }
```

ìœ ì €ë¥¼ ë“±ë¡í•˜ëŠ” POST ë©”ì„œë“œ APIì— GET ìš”ì²­ì„ í•˜ì˜€ì„ ë•Œ,
`405 METHOD_NOT_ALLOWED` ì—ëŸ¬ë¥¼ ë°˜í™˜í•´ì•¼í–ˆì§€ë§Œ

```html
<!doctype html>
<html lang="ko">

<head>
    <meta charset="utf-8">
    <meta name="viewport"
        content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width">
    <meta name="next-head-count" content="2">
    <meta http-equiv="x-ua-compatible" content="IE=edge">
    <meta content="website" property="og:type">
    <meta content="ì¹´ì¹´ì˜¤ê³„ì •" property="og:title">
    <meta content="https://accounts.kakaocdn.net/images/og_kakao.png" property="og:image">
    <script type="text/javascript" src="//t1.daumcdn.net/tiara/js/v1/tiara.min.js" defer></script>
    <link rel="preload" href="https://accounts.kakaocdn.net/_next/static/css/4c10cf947c806172.css" as="style">
    <link rel="stylesheet" href="https://accounts.kakaocdn.net/_next/static/css/4c10cf947c806172.css" data-n-g="">
    <link rel="preload" href="https://accounts.kakaocdn.net/_next/static/css/a9486ddd6d4b3bef.css" as="style">
    <link rel="stylesheet" href="https://accounts.kakaocdn.net/_next/static/css/a9486ddd6d4b3bef.css" data-n-p="">
    <link rel="preload" href="https://accounts.kakaocdn.net/_next/static/css/2f1d8a5bd195ff97.css" as="style">
    <link rel="stylesheet" href="https://accounts.kakaocdn.net/_next/static/css/2f1d8a5bd195ff97.css" data-n-p="">
    <noscript data-n-css=""></noscript>
    <script defer nomodule="" src="https://accounts.kakaocdn.net/_next/static/chunks/polyfills-5cd94c89d3acac5f.js">
    </script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/webpack-06fc05ffda14b141.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/framework-f8115f7fae64930e.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/main-a7d45bce11193232.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/pages/_app-7c592d7e99f1ec02.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/29107295-f5d3d9a71e7e292a.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/39694-4cf1f4ff8ab2886e.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/69695-9ee32dd2295c9b6f.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/34853-0efce61660864821.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/47490-94363953cc8690c8.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/95939-120f25eb86d0ade6.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/5461-fa3639993a4cbbb0.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/3889-47f37a84cb88373a.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/93171-b76eb1e385744e24.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/pages/login/login-3917652c4ae8dd7b.js" defer>
    </script>
    <script src="https://accounts.kakaocdn.net/_next/static/WIzczCRZ_Fqwm1G9ryDEv/_buildManifest.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/WIzczCRZ_Fqwm1G9ryDEv/_ssgManifest.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/WIzczCRZ_Fqwm1G9ryDEv/_middlewareManifest.js" defer>
    </script>
</head>

<body class="os_other pc type_responsive app_view">
    <div id="__next" data-reactroot=""></div>
    <script id="__NEXT_DATA__" type="application/json">
        {"props":{"pageProps":{"pageContext":{"commonContext":{"locale":"ko","uaClass":"os_other  pc","responsiveView":true,"responsivePopup":false,"mobile":false,"webview":{"app":"web","webViewType":"none","appVersion":"","os":"other","osVersion":"","supportNavigation":false,"supportFilePicker":true,"supportExecUrlScheme":false,"supportMarketUrlScheme":true},"supportRefererMetaTag":false,"showHeader":false,"showFooter":true,"isLogin":false,"linkParams":{},"displayId":null,"isTalkUser":false,"isCorporation":false,"syncUrl":null,"showPasskey":true,"darkMode":null,"_csrf":"b16403e5-ada7-4950-9949-b3ddbec82106","kage_file_max_size":100,"upload_kage_url":"https://up-api1-kage.kakao.com/up/kaccount-p/","p":"01SayCrnha4sLgx8zt6z_CjJRwQL7yBZo-CuP67vHUg"},"context":{"webType":"web","defaultEmail":null,"showStaySignIn":true,"defaultStaySignIn":false,"appendStaySignedIn":false,"defaultCountryCode":"KR_82","showQrLogin":true,"showWebTalkLogin":false,"showDeviceFormLogin":false,"showPasskeyLogin":true,"needCaptcha":false,"showIpSecurity":false,"loginUrl":"/login?continue=https%3A%2F%2Fkauth.kakao.com%2Foauth%2Fauthorize%3Fresponse_type%3Dcode%26state%3DYOV2Ai4MRpuzLEEBRGNLCEiZ056SU5AVH49YlrMyToE%253D%26redirect_uri%3Dhttp%253A%252F%252Flocalhost%253A8080%252Flogin%252Foauth2%252Fcode%252Fkakao%26client_id%3D1f1181f4cf9440667d5179e0a87f63d7%26scope%3Dprofile_nickname%26through_account%3Dtrue","continueUrl":"https://kauth.kakao.com/oauth/authorize?response_type=code&state=YOV2Ai4MRpuzLEEBRGNLCEiZ056SU5AVH49YlrMyToE%3D&redirect_uri=http%3A%2F%2Flocalhost%3A8080%2Flogin%2Foauth2%2Fcode%2Fkakao&client_id=1f1181f4cf9440667d5179e0a87f63d7&scope=profile_nickname&through_account=true","useSimpleLogin":true,"exceedSimpleLoginLimit":false,"defaultSaveSignIn":false,"isTalkLoginError":false,"linkParams":{"lang":["ko"]},"requests":{"check_daum_sso":["get","https://logins.daum.net/accounts/endpoint/favicon.ico"]},"isDaum":false,"banner":null}}}},"page":"/login/login","query":{},"buildId":"WIzczCRZ_Fqwm1G9ryDEv","assetPrefix":"https://accounts.kakaocdn.net","nextExport":true,"isFallback":false,"gip":true,"scriptLoader":[]}
    </script>
</body>

</html>
```

ìœ„ì™€ ê°™ì€ ìš”ìƒí•œ htmlë¬¸ë§Œ ê³„ì†í•´ì„œ ë°˜í™˜ì„ í–ˆë‹¤.

```java
@Slf4j
@RestControllerAdvice(annotations = {RestController.class})
public class GeneralExceptionAdvice extends ResponseEntityExceptionHandler {

...
```

ì „ì—­ ì—ëŸ¬ ì²˜ë¦¬ë¥¼ ë‹´ë‹¹í•˜ëŠ” `GeneralExceptionAdvice` í´ë˜ìŠ¤ì—ì„œ 405 ì—ëŸ¬ì— ëŒ€í•œ ì»¤ìŠ¤í…€ì„ ì§„í–‰í•˜ì§€ëŠ” ì•Šì•˜ì§€ë§Œ, `ResponseEntityExceptionHandler`ë¥¼ ìƒì† ë°›ì•˜ê¸°ì— ê¸°ë³¸ì ì¸ ì—ëŸ¬ ì²˜ë¦¬ëŠ” ë˜ì—ˆì–´ì•¼í–ˆë‹¤.

---

# ğŸƒğŸ» ì‹œë„í•´ ë³¸ ë°©ë²•ë“¤

ì—ëŸ¬ ì²˜ë¦¬ê°€ ì œëŒ€ë¡œ ë˜ì§€ ì•ŠëŠ” ìœ„ì˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³ ì ì•„ë˜ì™€ ê°™ì€ ì—¬ëŸ¬ ë°©ë²•ë“¤ì„ ì‹œë„í–ˆë‹¤.

## 1. Spring Securityì—ì„œ ì¸ì¦ ë° ê¶Œí•œ ê´€ë ¨ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì„¤ì •

### SecurityConfig

```java
	@Bean
    public SecurityFilterChain filterChain(HttpSecurity httpSecurity, AuthenticationEntryPoint authenticationEntryPoint) throws Exception {
        httpSecurity
                .httpBasic(HttpBasicConfigurer::disable)
                .formLogin(AbstractHttpConfigurer::disable)
                .httpBasic(AbstractHttpConfigurer::disable)
                .requestCache(AbstractHttpConfigurer::disable)
                .cors(corsConfigurer -> corsConfigurer.configurationSource(corsConfigurationSource()))
                .csrf(AbstractHttpConfigurer::disable)
                .exceptionHandling(exceptionHandlingConfigurer ->
                        exceptionHandlingConfigurer
                                .authenticationEntryPoint(authenticationEntryPoint)
                                .accessDeniedHandler(customAccessDeniedHandler)
                )
                .addFilterBefore(new JwtFilter(jwtUtil, cookieUtil), ExceptionTranslationFilter.class)
                .oauth2Login(oauth ->
                        oauth
                                .successHandler(oAuthLoginSuccessHandler)
                                .failureHandler(oAuthLoginFailureHandler)
                )
                .sessionManagement(session -> session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))
                .authorizeHttpRequests(authorize ->
                        authorize
                                .requestMatchers(allowedUrls).permitAll()
                                .anyRequest().authenticated()
                );
        return httpSecurity.build();
    }
```

SecurityConfig ì½”ë“œì—ì„œ

```java
                .exceptionHandling(exceptionHandlingConfigurer ->
                        exceptionHandlingConfigurer
                                .authenticationEntryPoint(authenticationEntryPoint)
                                .accessDeniedHandler(customAccessDeniedHandler)
                )
```

í•´ë‹¹ ë¶€ë¶„ì„ ì¶”ê°€í•˜ì—¬ ëª…ì‹œì ìœ¼ë¡œ ì˜ˆì™¸ ì²˜ë¦¬ í•¸ë“¤ëŸ¬ë¥¼ ì„¤ì •í•´ì¤€ë‹¤.

### authenticationEntryPoint

```java
    @Bean
    public AuthenticationEntryPoint authenticationEntryPoint() {
        return (request, response, authException) -> {
            ObjectMapper mapper = new ObjectMapper();
            ErrorStatus errorStatus = ErrorStatus.UNAUTHORIZED;
            response.setContentType(MediaType.APPLICATION_JSON_VALUE);
            response.setCharacterEncoding("UTF-8");
            response.setStatus(errorStatus.getHttpStatus().value());
            ApiResponse<Object> errorResponse = ApiResponse.error(ErrorStatus.UNAUTHORIZED).getBody();
            response.getWriter().write(mapper.writeValueAsString(errorResponse));
        };
    }
```

AuthenticationEntryPointì€ ìœ„ì²˜ëŸ¼ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•˜ì—¬, 
ì‚¬ìš©ìê°€ ì¸ì¦ë˜ì§€ ì•Šì€ ìƒíƒœë¡œ ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•˜ë ¤ê³  í•˜ë©´ `UNAUTHORIZED` ì—ëŸ¬ ì‘ë‹µì„ ë°˜í™˜í•œë‹¤.

![](https://velog.velcdn.com/images/hsh111366/post/f3755553-0a4b-404f-8ed9-25eac51b9e6b/image.png)

ê·¸ ê²°ê³¼ ìœ„ì²˜ëŸ¼ 401 ì—ëŸ¬ëŠ” ë°›ì„ ìˆ˜ ìˆì—ˆì§€ë§Œ,
ìš°ë¦¬ê°€ ì›í•˜ëŠ” ê²ƒì€ 405 ì—ëŸ¬ ì‘ë‹µì´ì—ˆê¸°ì— ë‹¤ë¥¸ ë°©ë²•ì„ ì‹œë„í–ˆë‹¤.

## 2. HttpRequestMethodNotSupportedException ì—ëŸ¬ ì²˜ë¦¬ ì¶”ê°€

ì§€ì›í•˜ì§€ ì•ŠëŠ” HTTP ë©”ì†Œë“œ ìš”ì²­ì´ ë“¤ì–´ì˜¨ ê²½ìš°ì—ëŠ” `HttpRequestMethodNotSupportedException` ë°œìƒí•˜ê²Œ ë˜ê³ , ì´ ê²½ìš°ì— `405 METHOD_NOT_ALLOWED` ì—ëŸ¬ë¥¼ ë°˜í™˜í•´ì¤€ë‹¤.

ë•Œë¬¸ì— ìœ„ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•´ì¤„ ìˆ˜ ìˆëŠ” ë©”ì„œë“œë¥¼ `GeneralExceptionAdvice` ë‚´ì— ë§Œë“¤ì–´ì£¼ì—ˆë‹¤.

```java
	// HttpRequestMethodNotSupportedException ì²˜ë¦¬ (ì§€ì›í•˜ì§€ ì•ŠëŠ” HTTP ë©”ì†Œë“œ ìš”ì²­ì´ ë“¤ì–´ì˜¨ ê²½ìš°)
    @Override
    protected ResponseEntity<Object> handleHttpRequestMethodNotSupported(HttpRequestMethodNotSupportedException ex,
                                                                         HttpHeaders headers,
                                                                         HttpStatusCode status,
                                                                         WebRequest request) {
        String errorMessage = "ì§€ì›í•˜ì§€ ì•ŠëŠ” HTTP ë©”ì†Œë“œ ìš”ì²­ì…ë‹ˆë‹¤: " + ex.getMethod();
        logError("HttpRequestMethodNotSupportedException", errorMessage);
        return ApiResponse.error(ErrorStatus.METHOD_NOT_ALLOWED, errorMessage);
    }
```

ìœ„ì—ì„œ ì–¸ê¸‰í•œ ê²ƒì²˜ëŸ¼ `ResponseEntityExceptionHandler` ë¥¼ ìƒì† ë°›ê³  ìˆê¸° ë•Œë¬¸ì—, ì˜¤ë²„ë¼ì´ë“œë¥¼ í†µí•´ì„œ ë©”ì„œë“œë¥¼ êµ¬í˜„í•´ì•¼í–ˆë‹¤.

ì´ì— ëŒ€í•œ ë‚´ìš©ì€ [ì „í¸](https://velog.io/@hsh111366/ì—ëŸ¬ë¥¼-ì¥ì¡ë“¯ì´-ì¡ì•„ë³´ì-2)ì—ì„œ í™•ì¸í•´ ë³´ì•„ë„ ì¢‹ì„ ê²ƒ ê°™ë‹¤!

í•˜ì§€ë§Œ ê·¸ëŸ¼ì—ë„ ì—¬ì „íˆ htmlì„ ë°˜í™˜í–ˆë‹¤..ì‚¬ì‹¤ ì• ì´ˆì— ì—ëŸ¬ ì²˜ë¦¬ ìì²´ê°€ ì•ˆë˜ê³  ìˆëŠ” ê²ƒì´ê¸°ì— ë‹¹ì—°í•œ ê²°ê³¼ì´ê¸°ëŠ” í–ˆë‹¤.

## âœ… 3. ê¸°ì¡´ ì½”ë“œì™€ì˜ ë¹„êµ

ì§€ê¸ˆê¹Œì§€ ë‚´ê°€ ì•„ëŠ” ì§€ì‹ìœ¼ë¡œëŠ” í•´ê²°í•  ìˆ˜ ì—†ë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹«ì•˜ë‹¤ ğŸ¤¯
ê²°êµ­ ê¸°ì¡´ì— ë‚´ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš© ì¤‘ì¸ ì „ì—­ ì—ëŸ¬ ì²˜ë¦¬ ì½”ë“œì™€ ë¬´ì–¸ê°€ ë‹¤ë¥¸ ì ì´ ìˆì„ ê²ƒì´ë¼ê³  ìƒê°í•˜ê³  ë¹„êµë¥¼ í•´ ë³´ì•˜ë‹¤.

ê·¸ëŸ¬ë‹¤ í•œ ê°€ì§€ ë‹¤ë¥¸ ì ì„ ë°œê²¬í•˜ê²Œ ë˜ì—ˆëŠ”ë°...

```java
@Slf4j
@RestControllerAdvice(annotations = {RestController.class})
public class GeneralExceptionAdvice extends ResponseEntityExceptionHandler {

...
```

ì—¬ê¸°ì„œ `@RestControllerAdvice(annotations = {RestController.class})` ì´ ë¶€ë¶„ì´ì—ˆë‹¤.

`(annotations = {RestController.class})` ë¥¼ ì œê±°í•˜ê³  APIë¥¼ í˜¸ì¶œí•˜ì..

![](https://velog.velcdn.com/images/hsh111366/post/239a7da5-ddc2-4c2e-ad38-900af9711a86/image.png)

í™”ë©´ê³¼ ê°™ì´ 405 ì—ëŸ¬ ì²˜ë¦¬ê°€ ì˜ ì§„í–‰ì´ ë˜ì—ˆë‹¤! ğŸ«¢

---

# ğŸ¤” ì™œ ëœ ê±°ì§€?

ë¬¸ì œëŠ” í•´ê²°ë˜ì–´ ê¸°ë¶„ì´ ì¢‹ì•˜ìœ¼ë‚˜...
`(annotations = {RestController.class})` ë¼ëŠ” ì½”ë“œëŠ” ì²˜ìŒ ë³´ì•„ ì •í™•íˆ ì–´ë–¤ ê²ƒ ë•Œë¬¸ì— í•´ê²°ì´ ëœ ê²ƒì¸ì§€ ì•Œ ìˆ˜ ì—†ì—ˆë‹¤.

ì°¾ì•„ë³´ë‹ˆ í•´ë‹¹ ì½”ë“œëŠ” `@RestController` ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì¸ í´ë˜ìŠ¤ì—ì„œ ë°œìƒí•œ ì—ëŸ¬ë“¤ë§Œì„ ì²˜ë¦¬í•´ì¤€ë‹¤ëŠ” ì˜ë¯¸ë¼ê³  í•œë‹¤.

ì—¬ê¸°ì„œ í•œ ê°€ì§€ ë˜ ì˜ë¬¸ì´ ë“  ì ì€..
`405 ì—ëŸ¬ë„ API í˜¸ì¶œí•  ë•Œ ë°œìƒí•˜ëŠ” ê²ƒì´ ì•„ë‹Œê°€?` ì˜€ë‹¤.

ì˜ë¬¸ì ì„ í•´ê²°í•˜ê¸° ìœ„í•´, Chat GPTì™€ í•¨ê»˜ Spring MVCì˜ ìš”ì²­ ì²˜ë¦¬ ê³¼ì •ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì•˜ë‹¤.

## Spring MVCì˜ ìš”ì²­ ì²˜ë¦¬ ê³¼ì •

### 1. í´ë¼ì´ì–¸íŠ¸ ìš”ì²­

ì‚¬ìš©ìê°€ ë¸Œë¼ìš°ì €ë‚˜ í´ë¼ì´ì–¸íŠ¸ì—ì„œ íŠ¹ì • URLë¡œ ìš”ì²­ì„ ë³´ë‚¸ë‹¤.

### 2. Servlet ì»¨í…Œì´ë„ˆ

ìš”ì²­ì€ í†°ìº£(Tomcat) ë“±ì˜ ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆë¡œ ë“¤ì–´ì˜¨ë‹¤.
ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆëŠ” ìš”ì²­ì„ ê°€ì¥ ë¨¼ì € ë°›ì•„ë“¤ì´ë©°, Spring Bootì—ì„œëŠ” ì´ ìš”ì²­ì´ `DispatcherServlet`ìœ¼ë¡œ ì „ë‹¬ëœë‹¤.

### 3. DispatcherServlet (ì¤‘ì•™ ì²˜ë¦¬ê¸°)

Spring MVCì˜ í•µì‹¬ì¸ DispatcherServletì€ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ì¤‘ì•™ ì§„ì…ì ì´ë‹¤.
DispatcherServletì€ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì•„ë˜ì˜ ìˆœì„œë¥¼ ë”°ë¥¸ë‹¤.

#### 3-1. HandlerMapping

DispatcherServletì€ ìš”ì²­ì— ë§ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì°¾ê¸° ìœ„í•´ HandlerMappingì„ ì‚¬ìš©í•œë‹¤.

ë§Œì•½ ì—¬ê¸°ì„œ ë§¤í•‘ëœ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì—†ìœ¼ë©´ 404 Not Found ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤.

#### 3-2. HandlerAdapter

HandlerMappingì´ ë§¤í•‘ëœ í•¸ë“¤ëŸ¬ë¥¼ ì°¾ìœ¼ë©´, ìš”ì²­ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” HandlerAdapterë¥¼ ì¡°íšŒí•œë‹¤.
HandlerAdapterëŠ” ì‹¤ì œë¡œ í•¸ë“¤ëŸ¬ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ì—­í• ì„ í•œë‹¤.

#### 3-3. Controller í˜¸ì¶œ

HandlerAdapterëŠ” ì‹¤ì œ ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œ(@RestController, @Controller)ë¥¼ í˜¸ì¶œí•œë‹¤.
ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ìš”ì²­ì„ ì²˜ë¦¬í•œ í›„ ì ì ˆí•œ ì‘ë‹µ(ResponseEntity, JSON ë“±)ì„ ë°˜í™˜í•œë‹¤.

#### 3-4. Exception ì²˜ë¦¬

ë§Œì•½ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ìˆœì„œë¡œ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•œë‹¤.

1. ì»¨íŠ¸ë¡¤ëŸ¬ ë‚´ë¶€ì—ì„œ @ExceptionHandlerê°€ ì •ì˜ë˜ì–´ ìˆìœ¼ë©´ ì´ë¥¼ ì‹¤í–‰.
2. ì»¨íŠ¸ë¡¤ëŸ¬ ì™¸ë¶€ì—ì„œ @RestControllerAdviceë‚˜ @ControllerAdviceê°€ ë“±ë¡ëœ ê²½ìš° ì´ë¥¼ ì‹¤í–‰.
3. ìœ„ì—ì„œ ì²˜ë¦¬ë˜ì§€ ì•Šì€ ì˜ˆì™¸ëŠ” DispatcherServletì´ ê¸°ë³¸ ì˜ˆì™¸ ì²˜ë¦¬ê¸°ë¡œ ì „ë‹¬.

#### 3-5. ResponseEntityExceptionHandler

ë§Œì•½ `HttpRequestMethodNotSupportedException` ì²˜ëŸ¼ íŠ¹ì • ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´, `ResponseEntityExceptionHandler`ê°€ ì´ë¥¼ ì²˜ë¦¬í•œë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, ì§€ì›ë˜ì§€ ì•ŠëŠ” HTTP ë©”ì„œë“œ(405 Method Not Allowed) ìš”ì²­ì´ ë“¤ì–´ì˜¬ ê²½ìš°, `handleHttpRequestMethodNotSupported`ê°€ í˜¸ì¶œëœë‹¤.

#### 3-6. ì‘ë‹µ ë°˜í™˜

ìµœì¢…ì ìœ¼ë¡œ DispatcherServletì€ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë°˜í™˜ëœ ê²°ê³¼ ë˜ëŠ” ì˜ˆì™¸ ì²˜ë¦¬ ê²°ê³¼ë¥¼ í´ë¼ì´ì–¸íŠ¸ë¡œ ë°˜í™˜í•œë‹¤.

## ğŸ§¹ ì •ë¦¬

ìœ„ì—ì„œ ë‚˜ì—´í•œ ë‚´ìš©ë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ ë¬¸ì œì ì„ ì •ë¦¬í•´ë³´ê² ë‹¤. 

DispatcherServletì—ì„œ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ë°›ì€ í›„ **3-1. HandlerMapping** ë‹¨ê³„ì—ì„œ ìš”ì²­ì— ë§ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì°¾ê²Œ ë˜ëŠ”ë°, ë§Œì•½ HTTP ë©”ì„œë“œë¥¼ ì˜ëª» í˜¸ì¶œí•œ ê²½ìš° í•´ë‹¹ ë‹¨ê³„ì—ì„œ `HttpRequestMethodNotSupportedException` ì˜ˆì™¸ë¥¼ ë°œìƒí•˜ê²Œ ëœë‹¤.

í•˜ì§€ë§Œ `(annotations = {RestController.class})` ì½”ë“œë¡œ ì¸í•´ì„œ,
**3-3. Controller í˜¸ì¶œ** ë‹¨ê³„ë¶€í„° ë°œìƒí•˜ëŠ” ì˜ˆì™¸ì— ëŒ€í•´ì„œë§Œ ì „ì—­ ì²˜ë¦¬ë¥¼ í•˜ì˜€ê¸°ì— ê·¸ ì´ì „ ë‹¨ê³„ì—ì„œ ë°œìƒí•œ ì˜ˆì™¸ë“¤ì€ ì²˜ë¦¬í•  ìˆ˜ ì—†ì—ˆë˜ ê²ƒì´ë‹¤.

ë˜í•œ **3-5. ResponseEntityExceptionHandler** ë¶€ë¶„ì„ ë³´ë©´ íŠ¹ì • ì˜ˆì™¸ë“¤ì— ëŒ€í•´ì„œëŠ” `ResponseEntityExceptionHandler` ì—ì„œ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•´ì£¼ê¸°ì—, `(annotations = {RestController.class})` ë¥¼ ì œê±°í•œë‹¤ë©´ ê¼­ ì˜¤ë²„ë¼ì´ë“œë¥¼ í•˜ì§€ ì•Šì•„ë„ ì•„ë˜ì™€ ê°™ì€ ê¸°ë³¸ ì‘ë‹µì€ ë°›ì„ ìˆ˜ ìˆë‹¤.

![](https://velog.velcdn.com/images/hsh111366/post/c87cdb0b-a757-47a0-a5b5-5bc0c3027109/image.png)

ê²°ë¡ ì ìœ¼ë¡œ `(annotations = {RestController.class})` ì½”ë“œë¥¼ ì œê±°í•¨ìœ¼ë¡œì¨,
ì»¨íŠ¸ë¡¤ëŸ¬ ë‹¨ê³„ ë¿ë§Œ ì•„ë‹ˆë¼ ë‹¤ë¥¸ ë‹¨ê³„ì—ì„œ ë°œìƒí•˜ëŠ” ì˜ˆì™¸ë“¤ë„ ì²˜ë¦¬í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.

---

# ğŸ” htmlì„ íŒŒì•…í•´ë³´ì 

ì§€ê¸ˆê¹Œì§€ì˜ ê³¼ì •ìœ¼ë¡œ ë‹¤í–‰íˆ ë¬¸ì œëŠ” ì˜ í•´ê²°ì´ ë˜ì—ˆë‹¤ ğŸ˜®â€ğŸ’¨

í•˜ì§€ë§Œ ì‘ë‹µìœ¼ë¡œ ì˜¨ ìš”ìƒí•œ htmlë¬¸ì´ ìê¾¸ ë§ˆìŒì— ê±¸ë ¤ ì´ë¥¼ í•œ ë²ˆ íŒŒì•…í•´ë³´ê¸°ë¡œ í–ˆë‹¤.

```html
<!doctype html>
<html lang="ko">

<head>
    <meta charset="utf-8">
    <meta name="viewport"
        content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width">
    <meta name="next-head-count" content="2">
    <meta http-equiv="x-ua-compatible" content="IE=edge">
    <meta content="website" property="og:type">
    <meta content="ì¹´ì¹´ì˜¤ê³„ì •" property="og:title">
    <meta content="https://accounts.kakaocdn.net/images/og_kakao.png" property="og:image">
    <script type="text/javascript" src="//t1.daumcdn.net/tiara/js/v1/tiara.min.js" defer></script>
    <link rel="preload" href="https://accounts.kakaocdn.net/_next/static/css/4c10cf947c806172.css" as="style">
    <link rel="stylesheet" href="https://accounts.kakaocdn.net/_next/static/css/4c10cf947c806172.css" data-n-g="">
    <link rel="preload" href="https://accounts.kakaocdn.net/_next/static/css/a9486ddd6d4b3bef.css" as="style">
    <link rel="stylesheet" href="https://accounts.kakaocdn.net/_next/static/css/a9486ddd6d4b3bef.css" data-n-p="">
    <link rel="preload" href="https://accounts.kakaocdn.net/_next/static/css/2f1d8a5bd195ff97.css" as="style">
    <link rel="stylesheet" href="https://accounts.kakaocdn.net/_next/static/css/2f1d8a5bd195ff97.css" data-n-p="">
    <noscript data-n-css=""></noscript>
    <script defer nomodule="" src="https://accounts.kakaocdn.net/_next/static/chunks/polyfills-5cd94c89d3acac5f.js">
    </script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/webpack-06fc05ffda14b141.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/framework-f8115f7fae64930e.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/main-a7d45bce11193232.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/pages/_app-7c592d7e99f1ec02.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/29107295-f5d3d9a71e7e292a.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/39694-4cf1f4ff8ab2886e.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/69695-9ee32dd2295c9b6f.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/34853-0efce61660864821.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/47490-94363953cc8690c8.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/95939-120f25eb86d0ade6.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/5461-fa3639993a4cbbb0.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/3889-47f37a84cb88373a.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/93171-b76eb1e385744e24.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/chunks/pages/login/login-3917652c4ae8dd7b.js" defer>
    </script>
    <script src="https://accounts.kakaocdn.net/_next/static/WIzczCRZ_Fqwm1G9ryDEv/_buildManifest.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/WIzczCRZ_Fqwm1G9ryDEv/_ssgManifest.js" defer></script>
    <script src="https://accounts.kakaocdn.net/_next/static/WIzczCRZ_Fqwm1G9ryDEv/_middlewareManifest.js" defer>
    </script>
</head>
 
...
```

ì´ë¥¼ GPTì—ê²Œ ë¶„ì„í•´ë‹¬ë¼ í•˜ë‹ˆ,
`ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ í˜ì´ì§€ì˜ ì •ì  HTML ì½˜í…ì¸ ` ë¼ê³  ì•Œë ¤ì£¼ì—ˆë‹¤.

ì´ëŠ” ë³´í†µ ì¸ì¦ì´ í•„ìš”í•œ ìš”ì²­ì—ì„œì˜ ì¸ì¦ì´ ì‹¤íŒ¨í–ˆì„ ë•Œ ë°˜í™˜ì´ ë˜ëŠ”ë°,
ìœ ì € ë“±ë¡ì€ ì¸ì¦ì´ í•„ìš”í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ë”ìš± ì˜ë¬¸ì ì´ ë‚¨ì•˜ì—ˆë‹¤.

ìœ„ì˜ ê³¼ì •ë“¤ì„ ê²ªê³  ë‚˜ë‹ˆ **3-1. HandlerMapping** ë‹¨ê³„ì—ì„œ ë°œìƒí•œ ì˜ˆì™¸ê°€ ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬ ë˜ì§€ ëª» í–ˆê¸° ë•Œë¬¸ì—, `Spring Security` ì—ì„œ ì´ë¥¼ ìì²´ì ìœ¼ë¡œ ì²˜ë¦¬í•œ ê²ƒì´ë¼ëŠ” ê±¸ ì•Œ ìˆ˜ ìˆì—ˆë‹¤.

ì¹´ì¹´ì˜¤ ì†Œì…œ ë¡œê·¸ì¸ì„ êµ¬í˜„í•œ ìƒíƒœì´ê³ , ì•„ë˜ application.yaml íŒŒì¼ì˜

```yaml
  security:
    oauth2:
      client:
        registration:
```

í•´ë‹¹ ë¶€ë¶„ì˜ í•˜ìœ„ì— ìˆëŠ” í”Œë«í¼ ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë˜ì—ˆë˜ ê²ƒì´ë‹¤.

ë§Œì•½ì— `annotations = {RestController.class})` ì½”ë“œë¥¼ ê¼­ ì¨ì•¼í•œë‹¤ë©´,

```java
 	@Bean
    public AuthenticationEntryPoint authenticationEntryPoint() {
        return (request, response, authException) -> {
            ObjectMapper mapper = new ObjectMapper();
            ErrorStatus errorStatus = ErrorStatus.UNAUTHORIZED;
            response.setContentType(MediaType.APPLICATION_JSON_VALUE);
            response.setCharacterEncoding("UTF-8");
            response.setStatus(errorStatus.getHttpStatus().value());
            ApiResponse<Object> errorResponse = ApiResponse.error(ErrorStatus.UNAUTHORIZED).getBody();
            response.getWriter().write(mapper.writeValueAsString(errorResponse));
        };
    }
```

ìœ„ì—ì„œë„ ì–¸ê¸‰í•œ AuthenticationEntryPoint ì»¤ìŠ¤í…€ì„ ì§„í–‰í•´ì•¼ ë‹¤ë¥¸ ë‹¨ê³„ì—ì„œë„ ë°œìƒí•˜ëŠ” ì—ëŸ¬ë“¤ì„ ì¡ì„ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

### íŒŒì¼ ì—´ì–´ë³´ê¸°

![](https://velog.velcdn.com/images/hsh111366/post/35fb7df3-251d-4bcd-9abd-2b94ca521074/image.png)

htmlë¬¸ì„ ë³µì‚¬í•´ì„œ vscodeì—ì„œ ë¶™ì—¬ë„£ì€ í›„ ì €ì¥í•˜ê³ 

![](https://velog.velcdn.com/images/hsh111366/post/3224c046-8110-44cd-900f-073af3ee8d41/image.png)

ì €ì¥ëœ íŒŒì¼ì„ ë”ë¸”í´ë¦­í•˜ê²Œ ë˜ë©´

![](https://velog.velcdn.com/images/hsh111366/post/f1299576-9408-436e-87d7-108ad9d1b33b/image.png)

ì´ë ‡ê²Œ ì¹´ì¹´ì˜¤í†¡ ë¡œê·¸ì¸ ê¸°ë³¸ í˜ì´ì§€ê°€ ì—´ë¦¬ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤!

![](https://velog.velcdn.com/images/hsh111366/post/1703dec4-9dd8-4422-bb7e-4cf61b620e31/image.png)

ë¬¼ë¡  ì´ëŠ” ì •ì  íŒŒì¼ì´ê¸° ë•Œë¬¸ì— ë™ì‘ì€ ë˜ì§€ ì•ŠëŠ”ë‹¤.

---

# ğŸ’¡ ëŠë‚€ ì 

1. ì´ì „ì—ë„ html ë¬¸ìœ¼ë¡œ ì—ëŸ¬ ì‘ë‹µì´ ì˜¤ëŠ” ê²½ìš°ë¥¼ ëª‡ ë²ˆ ë³´ì•˜ì—ˆëŠ”ë°, ì´ ë•ŒëŠ” ì¸ì¦ê³¼ ê´€ë ¨ëœ ë¬¸ì œì˜€ê¸°ì— ê¸ˆë°© í•´ê²°í•  ìˆ˜ ìˆì—ˆë‹¤. í•˜ì§€ë§Œ ì´ë²ˆì—ëŠ” ê´€ë ¨ì´ ì—†ë‹¤ê³  ìƒê°í•œ ë¶€ë¶„ì—ì„œ ë¬¸ì œê°€ ìˆì—ˆê¸°ì— ì´í•´í•˜ëŠ” ë° ì˜¤ë˜ ê±¸ë ¸ë˜ ê²ƒ ê°™ë‹¤.
2. í•´ê²°í•œ ë‹¹ì‹œì—ëŠ” ë¬¸ì œì¸ ì½”ë“œë§Œ ì œê±°ë¥¼ í•˜ê³  ì œëŒ€ë¡œ ì´í•´í•˜ì§€ëŠ” ì•Šì•˜ì—ˆëŠ”ë°...ë§‰ìƒ ê¸€ì„ ì“°ë ¤ê³  ì•Œì•„ë³´ë‹¤ ë³´ë‹ˆ ìƒê°ë³´ë‹¤ ì´í•´í•´ì•¼í•  ë¶€ë¶„ë“¤ì´ ë§ì•˜ë˜ ê²ƒ ê°™ë‹¤ ğŸ˜µ
3. `Spring MVCì˜ ìš”ì²­ ì²˜ë¦¬ ê³¼ì •`ì— ëŒ€í•´ì„œ ì•Œ ìˆ˜ ìˆì–´ì„œ ì¢‹ì•˜ë‹¤! ì—ëŸ¬ ì²˜ë¦¬ë¥¼ ì—¬ëŸ¬ ë²ˆ ì§„í–‰í•˜ê³  ê³µë¶€í–ˆì§€ë§Œ, ì§€ê¸ˆê¹Œì§€ ì–´ëŠ ë‹¨ê³„ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ëŠ”ì§€ì— ëŒ€í•´ì„œëŠ” ì•Œì§€ ëª»í–ˆë˜ ê²ƒ ê°™ë‹¤. ì´ë¥¼ ì•Œê³  ë‚˜ë‹ˆ ë‹¤ìŒë¶€í„°ëŠ” ì¡°ê¸ˆ ë” ìƒí™©ì— ë§ëŠ” ì—ëŸ¬ ì²˜ë¦¬ ê¸°ëŠ¥ì„ êµ¬í˜„í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.
4. ì—­ì‹œ ìµœëŒ€í•œ ë§ì€ ì‚¬ëŒë“¤ê³¼ ëŒ€í™”ë¥¼ ë‚˜ëˆ„ì–´ ë³´ê³  ê²½í—˜ì„ ê³µìœ í•˜ëŠ” ê²ƒì€ ì¢‹ì€ ê²ƒ ê°™ë‹¤ ğŸ‘ğŸ» ì´ë²ˆ ê³¼ì •ì„ í†µí•´ì„œ ë§ì´ ë°°ìš¸ ìˆ˜ ìˆì—ˆë˜ ê²ƒ ê°™ë‹¤.
