---
date: 2025-11-15
tags:
  - troubleshooting
  - backend
  - springboot
  - jpa
---
Trouble Shooting

---

# ğŸ ì„œë¡ 

Spring Bootì—ì„œ JPAë¥¼ ì‚¬ìš©í•˜ë©° `@CreationTimestamp`ì„ í™œìš©í•´ CREATED_AT í•„ë“œë¥¼ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸ í•˜ë„ë¡ í•˜ì˜€ë‹¤.

í•˜ì§€ë§Œ DBë¥¼ í™•ì¸í•˜ë˜ ì¤‘, **ë¨¼ì € ì €ì¥ëœ ë ˆì½”ë“œì˜ ìƒì„± ì¼ìê°€ ë” ì´í›„ì˜ ì¼ìë¡œ ê¸°ë¡**ë˜ê³  ìˆìŒì„ ì•Œê²Œ ë˜ì—ˆë‹¤.

ì´ë²ˆ ê¸€ì€ ì´ì— ëŒ€í•œ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…ê³¼ ì•Œê²Œ ëœ ì ì— ëŒ€í•´ ì •ë¦¬í•´ ë³´ê³ ì í•œë‹¤.


---

# ğŸš¨ ë¬¸ì œ ìƒí™©

```java
	@Column(name = "CREATED_AT", nullable = false, columnDefinition = "TIMESTAMP(2)")
	@CreationTimestamp
	private LocalDateTime createdAt;
```

- ìœ„ì™€ ê°™ì´, ì—”í„°í‹° ì¤‘ createdAt í•„ë“œì—ëŠ” @CreationTimestampë¥¼ ì ìš©í•´ ë‘ì—ˆë‹¤.

```java
	@Column(name = "MODIFIED_AT", nullable = false, columnDefinition = "TIMESTAMP(2)")
	@UpdateTimestamp
	private LocalDateTime modifiedAt;
```

- ìœ„ì™€ ê°™ì´, ì—”í„°í‹° ì¤‘ modifiedAt í•„ë“œì—ëŠ” @UpdateTimestampë¥¼ ì ìš©í•´ ë‘ì—ˆë‹¤.

![](https://velog.velcdn.com/images/hsh111366/post/7ef50495-5734-4daa-9f6e-e40201deb373/image.png)

ë¨¼ì € ì €ì¥ëœ ë ˆì½”ë“œì˜ ìƒì„±ì¼ìê°€ ë” ë’¤ì¸ ëª¨ìŠµì´ë‹¤.

ë¡œì»¬(127.0.0.1)ì—ì„œ ì‹¤í–‰í•œ ê²½ìš°ì—ëŠ”, UTC+9ì¸ `Asia/Seoul` íƒ€ì„ì¡´ìœ¼ë¡œ ë“¤ì–´ê°”ì§€ë§Œ, í´ë¼ìš°ë“œ ì„œë²„ì—ì„œ êµ¬ë™ì¤‘ì¸ ì»¨í…Œì´ë„ˆ ì•±ì—ì„œëŠ” `UTC` ê¸°ì¤€ìœ¼ë¡œ insertê°€ ë˜ì—ˆë‹¤.

> ê·¸ ì´ìœ ê°€ ë¬´ì—‡ì¼ê¹Œ?

## DB íƒ€ì„ì¡´ í™•ì¸

DBì˜ íƒ€ì„ì¡´ì´ UTCë¡œ ë˜ì–´ ìˆì–´ì„œ ê·¸ëŸ° ê²ƒì€ ì•„ë‹ê¹Œ? í•œ ë²ˆ í™•ì¸í•´ ë³´ì•˜ë‹¤.

![](https://velog.velcdn.com/images/hsh111366/post/a51f3aa1-1229-4661-ad26-2e2a1343eee5/image.png)

```bash
# cat /etc/timezone
Etc/UTC
# ls -l /etc/localtime
lrwxrwxrwx 1 root root 27 Sep 19  2023 /etc/localtime -> /usr/share/zoneinfo/Etc/UTC
# date
Wed Nov  5 03:18:22 UTC 2025
```

í™•ì¸ ê²°ê³¼, UTC+9ë¡œ ì˜ ì„¤ì •ë˜ì–´ ìˆì—ˆë‹¤.

## ë„ì»¤ ì»¨í…Œì´ë„ˆ íƒ€ì„ì¡´ í™•ì¸

ë„ì»¤ ì»¨í…Œì´ë„ˆë¥¼ í™•ì¸í•´ ë³´ë‹ˆ, UTC íƒ€ì„ì¡´ìœ¼ë¡œ ëŒì•„ê°€ê³  ìˆì—ˆë‹¤.

![](https://velog.velcdn.com/images/hsh111366/post/d2b282a8-3b33-40dc-b843-64c2c629ccd8/image.png)


![](https://velog.velcdn.com/images/hsh111366/post/0887ac49-114d-4770-8aa0-81e5e89ea4c9/image.png)

ê·¸ë ‡ê¸°ì— ë¡œì»¬ í™˜ê²½ì—ì„œ ë™ì¼í•œ í™˜ê²½ì„ ë§ì¶”ì–´(-Duser.timezone=UTC ì˜µì…˜) í…ŒìŠ¤íŠ¸í•´ë³´ë‹ˆ, VMì˜ íƒ€ì„ì¡´ì„ ê·¸ëŒ€ë¡œ ë”°ë¥´ë©° UTC ê¸°ì¤€ìœ¼ë¡œ ë ˆì½”ë“œê°€ insertë˜ëŠ” ëª¨ìŠµì„ í™•ì¸í•˜ì˜€ë‹¤.

> **ì¦‰, í•´ë‹¹ ë¶€ë¶„ì—ì„œ ë¬¸ì œë¥¼ í•´ê²°í•´ì•¼ í•œë‹¤.**
>
DBëŠ” `Asia/Seoul`ë¡œ ì˜ ì„¤ì •ë˜ì–´ ìˆê³ , ì—¬ê¸°ì„œ ì²˜ìŒ ì‚¬ìš©í•´ ë³´ëŠ” ê²ƒì€ `@CreationTimestamp` ë¿ì´ê¸° ë•Œë¬¸ì— í•´ë‹¹ ê¸°ëŠ¥ì„ íŒŒí—¤ì³ë´ì•¼ ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆë‹¤.

---

# ğŸ” `@CreationTimestamp` íŒŒê³ ë“¤ê¸°



```java
/*
 * Hibernate, Relational Persistence for Idiomatic Java
 *
 * License: GNU Lesser General Public License (LGPL), version 2.1 or later.
 * See the lgpl.txt file in the root directory or <http://www.gnu.org/licenses/lgpl-2.1.html>.
 */
package org.hibernate.annotations;

import static java.lang.annotation.ElementType.FIELD;
import static java.lang.annotation.ElementType.METHOD;
import static java.lang.annotation.RetentionPolicy.RUNTIME;

import java.lang.annotation.Retention;
import java.lang.annotation.Target;

import org.hibernate.generator.internal.CurrentTimestampGeneration;

/**
 * Specifies that the annotated field of property is a generated <em>creation timestamp</em>.
 * The timestamp is generated just once, when an entity instance is inserted in the database.
 * <p>
 * By default, the timestamp is generated by {@linkplain java.time.Clock#instant() in memory},
 * but this may be changed by explicitly specifying the {@link #source}.
 * Otherwise, this annotation is a synonym for
 * {@link CurrentTimestamp @CurrentTimestamp(timing=INSERT,source=VM)}.
 *
 * @author Gunnar Morling
 *
 * @see CurrentTimestamp
 */
@ValueGenerationType(generatedBy = CurrentTimestampGeneration.class)
@Retention(RUNTIME)
@Target({ FIELD, METHOD })
public @interface CreationTimestamp {
	/**
	 * Specifies how the timestamp is generated. By default, it is generated
	 * in memory, which saves a round trip to the database.
	 */
	SourceType source() default SourceType.VM;
}

```

- ì£¼ì„ì„ ì½ì–´ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

> **Specifies that the annotated field of property is a generated *creation timestamp*.** The timestamp is generated just once, when an entity instance is inserted in the database.
By default, the timestamp is generated by {@linkplain java.time.Clock#instant() in memory}, but this may be changed by explicitly specifying the {@link #source}.
Otherwise, this annotation is a synonym for {@link CurrentTimestamp @CurrentTimestamp(timing=INSERT,source=VM)}.

**ì–´ë…¸í…Œì´ì…˜ì´ ì§€ì •ëœ í•„ë“œ ë˜ëŠ” í”„ë¡œí¼í‹°ê°€ ìƒì„±ëœ *ìƒì„± íƒ€ì„ìŠ¤íƒ¬í”„*ì„ì„ ëª…ì‹œí•©ë‹ˆë‹¤.** ì´ íƒ€ì„ìŠ¤íƒ¬í”„ëŠ” ì—”í‹°í‹° ì¸ìŠ¤í„´ìŠ¤ê°€ ë°ì´í„°ë² ì´ìŠ¤ì— **ì‚½ì…ë  ë•Œ ë‹¨ í•œ ë²ˆ**ë§Œ ìƒì„±ë©ë‹ˆë‹¤.

ê¸°ë³¸ì ìœ¼ë¡œ íƒ€ì„ìŠ¤íƒ¬í”„ëŠ” {@linkplain java.time.Clock#instant() ë©”ëª¨ë¦¬ì—ì„œ} ìƒì„±ë˜ì§€ë§Œ, {@link #source}ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì§€ì •í•˜ì—¬ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë‹¤ë¥¸ ì„¤ì •ì´ ì—†ìœ¼ë©´ ì´ ì–´ë…¸í…Œì´ì…˜ì€ {@link CurrentTimestamp @CurrentTimestamp(timing=INSERT,source=VM)}ì™€ ë™ì˜ì–´ì…ë‹ˆë‹¤.

> **Specifies how the timestamp is generated.** By default, it is generated in memory, which saves a round trip to the database.

**íƒ€ì„ìŠ¤íƒ¬í”„ê°€ ì–´ë–»ê²Œ ìƒì„±ë˜ëŠ”ì§€ ëª…ì‹œí•©ë‹ˆë‹¤.** ê¸°ë³¸ì ìœ¼ë¡œëŠ” ë©”ëª¨ë¦¬ì—ì„œ ìƒì„±ë˜ë©°, ì´ëŠ” ë°ì´í„°ë² ì´ìŠ¤ë¡œì˜ ì™•ë³µ(round trip)ì„ ì¤„ì—¬ì¤ë‹ˆë‹¤.

> ğŸ’¡ **â€œì´ íƒ€ì„ìŠ¤íƒ¬í”„ëŠ” ì—”í‹°í‹° ì¸ìŠ¤í„´ìŠ¤ê°€ ë°ì´í„°ë² ì´ìŠ¤ì— ì‚½ì…ë  ë•Œ ë‹¨ í•œ ë²ˆë§Œ ìƒì„±ë©ë‹ˆë‹¤.â€**
- ì´ ë•Œë¬¸ì¸ì§€ ë“œë¬¼ì§€ë§Œ saveë¥¼ ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œí•˜ëŠ” ê²½ìš°ì—, í•´ë‹¹ í•„ë“œê°€ nullë¡œ ì €ì¥ë  ìˆ˜ê°€ ìˆë‹¤ê³  í•œë‹¤.
[[Spring boot] @CreationTimeStamp null after update](https://m.blog.naver.com/fbfbf1/222888472293)
    
> ğŸ’¡ **â€œë‹¤ë¥¸ ì„¤ì •ì´ ì—†ìœ¼ë©´ ì´ ì–´ë…¸í…Œì´ì…˜ì€ {@link CurrentTimestamp @CurrentTimestamp(timing=INSERT,source=VM)}ì™€ ë™ì˜ì–´ì…ë‹ˆë‹¤.â€ / â€œíƒ€ì„ìŠ¤íƒ¬í”„ê°€ ì–´ë–»ê²Œ ìƒì„±ë˜ëŠ”ì§€ ëª…ì‹œí•©ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œëŠ” ë©”ëª¨ë¦¬ì—ì„œ ìƒì„±ë˜ë©°, ì´ëŠ” ë°ì´í„°ë² ì´ìŠ¤ë¡œì˜ ì™•ë³µ(round trip)ì„ ì¤„ì—¬ì¤ë‹ˆë‹¤.â€**
- ì†ŒìŠ¤ ì½”ë“œì—ì„œ ë³´ì´ëŠ” ê²ƒì²˜ëŸ¼, ë””í´íŠ¸ ê°’ì€ VMì´ë‹¤.

```java
SourceType source() default SourceType.VM;
```

- ê·¸ë ‡ê¸° ë•Œë¬¸ì—, ì•„ë¬´ëŸ° ì˜µì…˜ì„ ì§€ì •í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ VMì˜ íƒ€ì„ì¡´ì„ ë”°ë¥´ê²Œ ëœë‹¤.

---

# âœ… í•´ê²° ë°©ë²•

## ë°©ë²• 1. @CreationTimestamp(source = SourceType.DB)

```java
	@Column(name = "CREATED_AT", nullable = false, columnDefinition = "TIMESTAMP(2)")
	@CreationTimestamp(source = SourceType.DB)
	private LocalDateTime createdAt;
	
	@Column(name = "MODIFIED_AT", nullable = false, columnDefinition = "TIMESTAMP(2)")
	@UpdateTimestamp(source = SourceType.DB)
	private LocalDateTime modifiedAt;
```

- ì†ŒìŠ¤ íƒ€ì…ì„ DBë¡œ ì„¤ì •í•˜ì—¬, DBì˜ íƒ€ì„ì¡´ê³¼ ë™ê¸°í™” ì‹œí‚¤ëŠ” ë°©ì‹ì´ë‹¤.
- **ì¼ê´€ì„± ì¸¡ë©´ì—ì„œ `SourceType.DB`ê°€ ì••ë„ì ìœ¼ë¡œ ìœ ë¦¬í•˜ë‹¤.**
- `SourceType.DB`ë¡œ ì„¤ì •í•˜ë©´, HibernateëŠ” `INSERT`ë‚˜ `UPDATE` ì¿¼ë¦¬ë¥¼ ìƒì„±í•  ë•Œ ì‹œê°„ ê°’ì„ ì§ì ‘ ë„£ëŠ” ëŒ€ì‹ , ë°ì´í„°ë² ì´ìŠ¤ì˜ ë‚´ì¥ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë„ë¡ SQLì„ ìƒì„±í•œë‹¤.
    - `INSERT INTO ... (created_at) VALUES (... a, now())`
    - `UPDATE ... SET updated_at = now() WHERE ...`

### ì‚¬ì´ë“œ ì´í™íŠ¸: **ì‹œì ì˜ ë¯¸ë¬˜í•œ ì°¨ì´**

- `SourceType.VM`: Javaì—ì„œ **ì—”í‹°í‹° ê°ì²´ê°€ ìƒì„±/ìˆ˜ì •ëœ ì‹œì **ì˜ ì‹œê°„
- `SourceType.DB`: ì´ ì—”í‹°í‹°ê°€ ì‹¤ì œ DB íŠ¸ëœì­ì…˜ì˜ ì¼ë¶€ë¡œ **ì»¤ë°‹ë˜ê±°ë‚˜ ì¿¼ë¦¬ê°€ ì‹¤í–‰ëœ ì‹œì **ì˜ ì‹œê°„

â†’ ë§Œì•½ íŠ¸ëœì­ì…˜ì´ ë§¤ìš° ê¸¸ê±°ë‚˜ í(Queue)ì— ì ì¬ë˜ì—ˆë‹¤ê°€ í•œì°¸ ë’¤ì— ì‹¤í–‰ëœë‹¤ë©´, ë‘ ì‹œê°„ì˜ ì°¨ì´ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.

## ë°©ë²• 2. SourceType.VM & ê¸°ë³¸ íƒ€ì„ì¡´ ë³€ê²½

ì´ ë°©ì‹ì€ `SourceType.VM`ì„ ìœ ì§€í•˜ë˜, ëª¨ë“  JVMê³¼ Docker ì»¨í…Œì´ë„ˆì˜ ê¸°ë³¸ íƒ€ì„ì¡´ì„ `Asia/Seoul` ë“±ìœ¼ë¡œ ê°•ì œí•˜ëŠ” ë°©ì‹ì´ë‹¤.

- **JVM ì˜µì…˜:** `java -Duser.timezone="Asia/Seoul" -jar app.jar`
- **Docker í™˜ê²½ ë³€ìˆ˜:** `ENV TZ="Asia/Seoul"`
- ì‹œê°„ì„ `ë©”ëª¨ë¦¬`ì—ì„œ ê°€ì ¸ì˜¤ê¸° ë•Œë¬¸ì—, ì„±ëŠ¥ì ìœ¼ë¡œ ë¯¸ì„¸í•˜ê²Œ ìš°ìˆ˜í•˜ë‹¤.
    - **(ì£¼ì„ ì¤‘) â€œê¸°ë³¸ì ìœ¼ë¡œëŠ” ë©”ëª¨ë¦¬ì—ì„œ ìƒì„±ë˜ë©°, ì´ëŠ” ë°ì´í„°ë² ì´ìŠ¤ë¡œì˜ ì™•ë³µ(round trip)ì„ ì¤„ì—¬ì¤ë‹ˆë‹¤.â€**

### **ì‚¬ì´ë“œ ì´í™íŠ¸ 1: ì„¤ì • ëˆ„ë½ì˜ ìœ„í—˜**

- ê°œë°œìê°€ ë¡œì»¬ì—ì„œ ì‹¤í–‰í•  ë•Œ, CI/CDì—ì„œ ë¹Œë“œí•  ë•Œ, Docker ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•  ë•Œ, ìš´ì˜ ì„œë²„ì— ë°°í¬í•  ë•Œ ë“± ëª¨ë“  í™˜ê²½ì—ì„œ íƒ€ì„ì¡´ ì„¤ì •ì„ **ë‹¨ í•œ ê³³ì´ë¼ë„ ë¹ ëœ¨ë¦¬ë©´** í•´ë‹¹ í™˜ê²½ì—ì„œë§Œ UTC(í˜¹ì€ ë‹¤ë¥¸ ê¸°ë³¸ê°’)ë¡œ ì‹œê°„ì´ ê¸°ë¡ë˜ì–´ ê¼¬ì¼ ìˆ˜ê°€ ìˆë‹¤.

### **ì‚¬ì´ë“œ ì´í™íŠ¸ 2: JVM ì „ì—­ ì„¤ì • ë³€ê²½**

- `Duser.timezone`ì€ í•´ë‹¹ JVMì˜ **ê¸°ë³¸ íƒ€ì„ì¡´**ì„ ë°”ê¿”ë²„ë¦°ë‹¤. ë§Œì•½ ì½”ë“œ ì–´ë”˜ê°€ì—ì„œ `LocalDateTime.now()`ì²˜ëŸ¼ íƒ€ì„ì¡´ ëª…ì‹œ ì—†ì´ í˜„ì¬ ì‹œê°„ì„ ê°€ì ¸ì˜¤ëŠ” ë‹¤ë¥¸ ë¡œì§ì´ ìˆë‹¤ë©´, ê·¸ ë¡œì§ì˜ ê²°ê³¼ê¹Œì§€ ëª¨ë‘ ë°”ë€Œì–´ë²„ë¦¬ëŠ” **ì „ì—­ì ì¸ ì‚¬ì´ë“œ ì´í™íŠ¸**ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.

> ğŸ§‘ğŸ»â€ğŸ’» **ê²°ê³¼ì ìœ¼ë¡œ, ì¼ê´€ì„±ì„ ì§€í‚¤ëŠ” ê²ƒì´ ê°€ì¥ ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°í•˜ì—¬ ë°©ë²• 1ì„ íƒí•˜ì—¬ í•´ê²°í•˜ì˜€ë‹¤.**

---

# ğŸ”— ë ˆí¼ëŸ°ìŠ¤

[@CreationTimestamp, LocalDateTime ì‹œê°„ ì„¤ì • ë°©ë²•](https://non-stop.tistory.com/705)
